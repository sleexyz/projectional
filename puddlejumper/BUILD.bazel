load("//:coarse.bzl", "dir", "dir_test")

dir(
    name = "puddlejumper",
    srcs = glob(
        ["**/*"],
        exclude = [
            "BUILD.bazel",
            "target/**/*",
            ".gitignore",
        ],
    ),
    cmd = "cargo build",
    deps = [
        "//tree-sitter-puddlejumper",
    ],
)

dir_test(
    name = "test",
    cmd = "cargo test --frozen --target-dir $TEST_TMPDIR",
    dir = ":puddlejumper",
)
